<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geolocation & Multiple IPs</title>
  </head>
  <body>
    <h1>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>
    <button onclick="getLocation()">‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <p id="output">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>

    <script>
      // ‡∏î‡∏∂‡∏á Public IPv4
      async function getIPv4() {
        try {
          let response = await fetch("https://api.ipify.org?format=json");
          let data = await response.json();
          return data.ip;
        } catch (error) {
          return "‡∏î‡∏∂‡∏á IPv4 ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
        }
      }

      // ‡∏î‡∏∂‡∏á Public IPv6
      async function getIPv6() {
        try {
          let response = await fetch("https://api64.ipify.org?format=json");
          let data = await response.json();
          return data.ip;
        } catch (error) {
          return "‡∏î‡∏∂‡∏á IPv6 ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
        }
      }

      // ‡∏î‡∏∂‡∏á Local IP (LAN)
      function getLocalIP(callback) {
        let pc = new RTCPeerConnection({ iceServers: [] });
        pc.createDataChannel("");
        pc.createOffer()
          .then((offer) => pc.setLocalDescription(offer))
          .catch(() => {});
        pc.onicecandidate = (event) => {
          if (event && event.candidate && event.candidate.candidate) {
            let ipMatch = event.candidate.candidate.match(
              /([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})/
            );
            let localIP = ipMatch ? ipMatch[1] : "‡∏î‡∏∂‡∏á Local IP ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ";
            callback(localIP);
            pc.close();
          }
        };
      }

      // ‡∏î‡∏∂‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î + IPs
      async function getLocation() {
        let ipv4 = await getIPv4();
        let ipv6 = await getIPv6();

        getLocalIP((localIP) => {
          if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
              (position) => {
                let lat = position.coords.latitude;
                let lon = position.coords.longitude;

                document.getElementById("output").innerHTML = `
                            üåç <b>Public IPv4:</b> ${ipv4} <br>
                            üåç <b>Public IPv6:</b> ${ipv6} <br>
                            üè† <b>Local IP (LAN):</b> ${localIP} <br>
                            üìç <b>Latitude:</b> ${lat} <br>
                            üìç <b>Longitude:</b> ${lon}
                        `;
              },
              (error) => {
                document.getElementById("output").innerHTML =
                  "Error: " + error.message;
              }
            );
          } else {
            document.getElementById("output").innerHTML =
              "Geolocation ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ";
          }
        });
      }
    </script>
  </body>
</html>
